<html>
  <head>
    <title>The Social Digits jQuery plugin example - popular products</title>
    
    <!-- Load jQuery. -->
    <script type="text/javascript" src="/jquery-1.7.1.min.js"></script>
    
    <!-- JSON support for legacy browsers. -->
    <script type="text/javascript" src="/json2.min.js"></script>
    
    <!-- The actual plugin for The Social Digits. -->
    <script type="text/javascript" src="/jquery.thesocialdigits.min.js"></script>
    
    <!-- Set global configuration of the plugin. Can be exported to an external
         JavaScript file since it is always the same. -->
    <script type="text/javascript">
      $.thesocialdigits({
        key: 'your_api_key', // TODO insert your API key here.
        
        datasource: function (products, callback) {
          /**
           * The function for loading product data for the products determined
           * by the API call. The function takes the list of product ids to 
           * fetch information for and a callback function. The callback function
           * takes a list of dictionaries corresponding to the template-date for
           * each product. Each key in the dictionary is mapped to a template
           * variable and each dictionary must contain the key id which contains
           * the product id.
           *
           * As an example if the products are [1,2,3] and the template contains
           * the variables id, name and price (as in the template below) the 
           * argument to callback should be: 
           *
           *   [{'id': 1, 'price': 12.0, 'name': 'Nice product 1'},
           *    {'id': 2, 'price': 8.0, 'name': 'Nice product 2'},
           *    {'id': 3, 'price': 14.0, 'name': 'Nice product 3'}]
           *
           * As default it uses the attributes API so in your template you can
           * use all attributes except the product description.
           */ 
          var url = 'http://api.thesocialdigits.com/v1/attributes?callback=?';
          var data = {
            'payload': JSON.stringify({
              'key': 'your_api_key', // TODO insert your API key here.
              'products': products,
              'language': 'english' // TODO add correct language
            })
          };
  
          $.getJSON(url, data, callback);
        }
      });
    </script>
  </head>
  <body>
  
  <!-- The list we want to display the popular products in. -->
  <ul id="products"></ul>
  
  <!-- The template to be used when rendering the products. 
       
       All variables in the template is denoted by {}, so the variable named var
       is denoted {var}. This template is applied to each product in the result
       from The Social Digits API method. Each key in the products 
       dictionary/object, given by the datasource function you have defined in
       the plugin configuration, is mapped to a variable name.
       
       Remember to set the type attribute to 'text/html' for templates.
   -->
  <script id="productsTemplate" type="text/html"> 
    <li>
      <a href="/product/{id}">
        <img src="/images/product/{id}.jpg" />
        {name} - {price},-
      </a>
    </li>
  </script>
  
  <!-- The actual use of the plugin. 
  
       This loads the three most popular products that costs less than 50 into
       the element having id 'products' using the template 'productsTemplate'.
   -->
  <script type="text/javascript">
    $('#products').thesocialdigits('popular', 
                                   {'limit': 3,
                                    'filter': 'price < 50'},
                                   '#productsTemplate');
  </script>
  
  </body>
</html>
    
